!!! 5
%html
  %head
    %title Custom Rails App
    = csrf_meta_tags
    = csp_meta_tag
    = stylesheet_link_tag "https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css", rel: "stylesheet"
    = stylesheet_link_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css", rel: "stylesheet"
    = stylesheet_link_tag "application", media: "all"
    = javascript_include_tag "https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js", defer: true
    = javascript_include_tag "application", defer: true

  %body.bg-light
    %nav.navbar.navbar-dark.bg-dark.shadow-sm
      .container-fluid
        - if user_signed_in?
          %button.btn.btn-outline-light.d-md-none.me-2{"data-bs-toggle" => "offcanvas", "data-bs-target" => "#mobileSidebar", "aria-controls" => "mobileSidebar"}
            %i.fas.fa-bars

        = link_to root_path, class: "navbar-brand fw-bold text-warning" do
          %img{ src: "https://download.logo.wine/logo/Ruby_on_Rails/Ruby_on_Rails-Logo.wine.png", alt: "Rails Logo", height: "40", class: "me-2" }

        #navbarNav.d-none.d-md-flex.align-items-center
          %ul.navbar-nav.ms-auto.flex-row.flex-wrap.align-items-center.gap-2
            - unless user_signed_in?
              %li.nav-item
                = link_to "Sign Up", new_user_registration_path, class: "nav-link text-white px-2"
              %li.nav-item
                = link_to "Staff Login", new_user_session_path(role: :staff), class: "nav-link text-white px-2"
              %li.nav-item
                = link_to "Customer Login", new_user_session_path(role: :customer), class: "nav-link text-white px-2"
            - if user_signed_in?
              %li.nav-item.ms-3
                - if current_user.avatar.attached?
                  = image_tag current_user.avatar.variant(resize_to_limit: [40, 40]), class: "rounded-circle", style: "height: 40px; width: 40px; object-fit: cover;"
                - else
                  = image_tag "/images/default_img.png", class: "rounded-circle", style: "height: 40px; width: 40px; object-fit: cover;"

    - if user_signed_in?
      .container-fluid
        .row
          .col-md-3.d-none.d-md-block
            .vh-100.bg-white.p-4.shadow-sm
              %ul.nav.flex-column
                %li.nav-item.mb-2
                  %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#profileMenu", role: "button"}
                    %i.fas.fa-user.me-2
                    My Profile
                  #profileMenu.collapse.ms-3
                    %ul.nav.flex-column
                      %li.nav-item
                        = link_to "Update Avatar", edit_avatar_path, class: "nav-link"
                      %li.nav-item
                        = link_to "Update Personal Data", edit_user_registration_path, class: "nav-link"

                - if current_user.customer?
                  %li.nav-item.mb-2
                    %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#ordersMenu", role: "button"}
                      %i.fas.fa-box.me-2
                      Orders
                    #ordersMenu.collapse.ms-3
                      %ul.nav.flex-column
                        %li.nav-item
                          = link_to "List of Orders", "#", class: "nav-link"
                        %li.nav-item
                          = link_to "Current Orders", "#", class: "nav-link"
                        %li.nav-item
                          = link_to "Past Orders", "#", class: "nav-link"
                - else
                  %li.nav-item.mb-2
                    %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#booksMenu", role: "button"}
                      %i.fas.fa-utensils.me-2
                      Restaurants
                    #booksMenu.collapse.ms-3
                      %ul.nav.flex-column
                        %li.nav-item
                          = link_to "Restaurants", restaurants_path, class: "nav-link"
                        %li.nav-item
                          = link_to "Create Restaurant", new_restaurant_path, class: "nav-link"

                %li.nav-item.mt-2
                  = button_to destroy_user_session_path, method: :delete, class: "nav-link text-danger fw-bold", data: { turbo: false } do
                    %i.fas.fa-sign-out-alt.me-2
                    Sign out

          .col-md-9.p-4
            %h2.text-success.mb-3 Hello, #{current_user.first_name}
            %p Welcome to your dashboard!

      .offcanvas.offcanvas-start.bg-white{id: "mobileSidebar", tabindex: "-1", "aria-labelledby" => "sidebarLabel"}
        .offcanvas-header
          %h5#sidebarLabel.offcanvas-title Menu
          %button.btn-close{"data-bs-dismiss" => "offcanvas", "aria-label" => "Close"}

        .offcanvas-body.p-3
          %ul.nav.flex-column
            %li.nav-item.mb-2
              %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#mProfileMenu", role: "button"}
                %i.fas.fa-user.me-2
                My Profile
              #mProfileMenu.collapse.ms-3
                %ul.nav.flex-column
                  %li.nav-item
                    = link_to "Update Avatar", edit_avatar_path, class: "nav-link"
                  %li.nav-item
                    = link_to "Update Personal Data", edit_user_registration_path, class: "nav-link"

            - if current_user.customer?
              %li.nav-item.mb-2
                %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#mOrdersMenu", role: "button"}
                  %i.fas.fa-box.me-2
                  Orders
                #mOrdersMenu.collapse.ms-3
                  %ul.nav.flex-column
                    %li.nav-item
                      = link_to "List of Orders", "#", class: "nav-link"
                    %li.nav-item
                      = link_to "Current Orders", "#", class: "nav-link"
                    %li.nav-item
                      = link_to "Past Orders", "#", class: "nav-link"
            - else
              %li.nav-item.mb-2
                %a.nav-link.fw-bold{"data-bs-toggle" => "collapse", href: "#mBooksMenu", role: "button"}
                  %i.fas.fa-utensils.me-2
                  Restaurants
                #mBooksMenu.collapse.ms-3
                  %ul.nav.flex-column
                    %li.nav-item
                      = link_to "Restaurants", restaurants_path, class: "nav-link"
                    %li.nav-item
                      = link_to "Create Restaurant", new_restaurant_path, class: "nav-link"

            %li.nav-item.mt-2
              = button_to destroy_user_session_path, method: :delete, class: "nav-link text-danger fw-bold", data: { turbo: false } do
                %i.fas.fa-sign-out-alt.me-2
                Sign out

    - else
      .container.mt-5
        .row.justify-content-center
          .col-md-8.text-center
            %h2.mb-4 Welcome to Custom Rails App!
            = link_to "Get Started", new_user_registration_path, class: "btn btn-warning btn-lg mt-3 shadow"
